<ui:FluentWindow x:Class="BetterGenshinImpact.View.Windows.CheckUpdateWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:local="clr-namespace:BetterGenshinImpact.View.Windows"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 xmlns:vio="http://schemas.lepo.co/wpfui/2022/xaml/violeta"
                 xmlns:emoji="clr-namespace:Emoji.Wpf;assembly=Emoji.Wpf"
                 xmlns:webview="clr-namespace:BetterGenshinImpact.View.Controls.Webview"
                 xmlns:behavior="clr-namespace:BetterGenshinImpact.View.Behavior"
                 x:Name="app"
                 Title="å‘çŽ°æ–°ç‰ˆæœ¬"
                 Width="680"
                 MinHeight="10"
                 SizeToContent="Height"
                 Background="#202020"
                 ExtendsContentIntoTitleBar="True"
                 behavior:AutoTranslateInterceptor.EnableAutoTranslate="True"
                 FontFamily="{DynamicResource TextThemeFontFamily}"
                 WindowBackdropType="Auto"
                 WindowStartupLocation="CenterOwner"
                 mc:Ignorable="d">
    <Grid>
        <ui:Grid Name="MyGrid" Margin="0,48,0,0" RowDefinitions="Auto,*,Auto,Auto">
            <webview:WebpagePanel x:Name="WebpagePanel"
                                  Grid.Row="1"
                                  Height="400"
                                  Margin="12,0,12,0" />
            <ui:Grid Name="UpdateStatusMessageGrid"
                     Grid.Row="0"
                     Margin="16,0,16,0"
                     ColumnDefinitions="Auto,*"
                     Visibility="{Binding ShowUpdateStatus, Converter={StaticResource BooleanToVisibilityConverter}}">
                <vio:Loading Grid.Column="0" />
                <ui:StackPanel Grid.Column="1" Margin="16,0,0,0">
                    <TextBlock Text="{Binding UpdateStatusMessage}" />
                </ui:StackPanel>
            </ui:Grid>
            <!-- æ–°å¢žï¼šå¤šæ¸ é“æ›´æ–°æ–¹å¼å¡ç‰‡ -->
            <StackPanel Name="ServerPanel" Grid.Row="2" Margin="12,0,12,0">
                <ui:CardControl Name="GitSourceCard" Margin="0,0,0,4" Padding="12,12">
                    <ui:CardControl.Icon>
                        <ui:FontIcon Glyph="&#xe13b;" Style="{StaticResource FaFontIconStyle}" />
                    </ui:CardControl.Icon>
                    <ui:CardControl.Header>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <ui:TextBlock Grid.Row="0"
                                          Grid.Column="0"
                                          FontTypography="Body"
                                          Text="å¼€æºæ¸ é“"
                                          TextWrapping="Wrap" />
                            <ui:TextBlock Grid.Row="1"
                                          Grid.Column="0"
                                          Foreground="{ui:ThemeResource TextFillColorTertiaryBrush}"
                                          Text="{Binding GitSourceDescription}"
                                          TextWrapping="Wrap" />
                        </Grid>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal">
                        <ComboBox x:Name="GitSourceComboBox"
                                  SelectedValue="{Binding SelectedGitSource}"
                                  SelectedValuePath="Content"
                                  Margin="0,0,8,0"
                                  MinWidth="80">
                            <ComboBoxItem Content="Github" />
                            <ComboBoxItem Content="CNB" />
                        </ComboBox>
                        <ui:Button
                            Icon="{ui:SymbolIcon ArrowDownload24}"
                            Content="ç«‹å³æ›´æ–°"
                            Command="{Binding UpdateFromGitHostPlatformCommand}" />
                    </StackPanel>
                </ui:CardControl>
                <ui:CardControl Name="SteambirdCard" Margin="0,0,0,4" Padding="12,12">
                    <ui:CardControl.Icon>
                        <ui:FontIcon Glyph="&#xf4ba;" Style="{StaticResource FaFontIconStyle}" />
                    </ui:CardControl.Icon>
                    <ui:CardControl.Header>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <emoji:TextBlock Grid.Row="0"
                                             Grid.Column="0"
                                             Text="Steambird æœåŠ¡ ðŸ†“"
                                             TextWrapping="Wrap" />
                            <ui:TextBlock Grid.Row="1"
                                          Grid.Column="0"
                                          Foreground="{ui:ThemeResource TextFillColorTertiaryBrush}"
                                          Text="ã€å›½å†…ã€‘æ™®é€šç”¨æˆ·å¯ç‚¹æ­¤ç›´æŽ¥æ›´æ–°"
                                          TextWrapping="Wrap" />
                        </Grid>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal">
                        <ui:Button
                            Appearance="Success"
                            Icon="{ui:SymbolIcon ArrowDownload24}"
                            Content="ç«‹å³æ›´æ–°"
                            Command="{Binding UpdateFromSteambirdCommand}" />
                    </StackPanel>
                </ui:CardControl>
                <ui:CardControl Margin="0,0,0,4" Padding="12,12">
                    <ui:CardControl.Icon>
                        <ui:FontIcon Glyph="&#xf0c2;" Style="{StaticResource FaFontIconStyle}" />
                    </ui:CardControl.Icon>
                    <ui:CardControl.Header>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <emoji:TextBlock Grid.Row="0"
                                          Grid.Column="0"
                                          Text="Mirroré…±æœåŠ¡ ðŸ’°"
                                          TextWrapping="Wrap" />
                            <ui:TextBlock Grid.Row="1"
                                          Grid.Column="0"
                                          Foreground="{ui:ThemeResource TextFillColorTertiaryBrush}"
                                          Text="ã€å›½å†…ã€‘Mirroré…±ç”¨æˆ·å¯ä»¥è¾“å…¥CDKé«˜é€Ÿæ›´æ–°"
                                          TextWrapping="Wrap" />
                        </Grid>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal">
                        <ui:Button 
                            Name="EditCdkButton"
                            Margin="0,0,8,0"
                            Icon="{ui:SymbolIcon TicketDiagonal24}"
                            Content="ä¿®æ”¹CDK"
                            Command="{Binding EditCdkCommand}" />
                        <ui:Button
                            Icon="{ui:SymbolIcon ArrowDownload24}"
                            Content="ç«‹å³æ›´æ–°"
                            Command="{Binding UpdateFromMirrorChyanCommand}" />
                    </StackPanel>
                </ui:CardControl>
                
                <!--<ui:CardControl Margin="0,0,0,8">
                    <ui:CardControl.Icon>
                        <ui:FontIcon Glyph="&#xf0c2;" Style="{StaticResource FaFontIconStyle}" />
                    </ui:CardControl.Icon>
                    <ui:CardControl.Header>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <emoji:TextBlock Grid.Row="0"
                                             Grid.Column="0"
                                             Text="Hutao Cloud èƒ¡æ¡ƒäº‘âš¡"
                                             TextWrapping="Wrap" />
                            <ui:TextBlock Grid.Row="1"
                                          Grid.Column="0"
                                          Foreground="{ui:ThemeResource TextFillColorTertiaryBrush}"
                                          Text="èƒ¡æ¡ƒäº‘CDNç”¨æˆ·ï¼Œå¯ä½¿ç”¨ Hutao Cloud CDN é«˜é€Ÿæ›´æ–°"
                                          TextWrapping="Wrap" />
                        </Grid>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal">
                        <ui:Button
                            Appearance="Primary"
                            Icon="{ui:SymbolIcon ArrowBounce24}"
                            Content="å”¤èµ·èƒ¡æ¡ƒ"
                            Command="{Binding OneKeyExecuteCommand}" />
                    </StackPanel>
                </ui:CardControl>-->
            </StackPanel>
            <!-- åŽŸæœ‰æŒ‰é’®åŒºåŸŸ -->
            <ui:Grid Grid.Row="3"
                     Margin="8"
                     ColumnDefinitions="*,Auto,Auto,Auto,Auto">
                <ui:Button Grid.Column="0"
                           MinWidth="90"
                           Margin="8,0,8,0"
                           Command="{Binding BackgroundUpdateCommand}"
                           Content="åŽå°æ›´æ–°"
                           Visibility="Collapsed" />
                <Grid Grid.Column="0">
                    <ui:Button x:Name="OtherUpdateButton"
                               Icon="{ui:SymbolIcon Globe24}"
                               Appearance="Primary"
                               MinWidth="90"
                               Margin="8,0,8,0"
                               Command="{Binding OtherUpdateCommand}"
                               Content="æ‰‹åŠ¨ä¸‹è½½" />
                    <!-- æ°”æ³¡æç¤º -->
                    <Popup x:Name="OtherUpdateTipPopup"
                            IsOpen="{Binding ShowOtherUpdateTip}"
                            PlacementTarget="{Binding ElementName=OtherUpdateButton}"
                            Placement="Top"
                            HorizontalOffset="0"
                            VerticalOffset="-3"
                            AllowsTransparency="True"
                            PopupAnimation="Fade">
                         <Grid>
                             <Border Background="#FF4A4A4A"
                                     CornerRadius="8"
                                     Padding="12,8"
                                     MaxWidth="200"
                                     MouseLeftButtonDown="OnCloseTipClick"
                                     Cursor="Hand">
                                 <Border.Effect>
                                     <DropShadowEffect Color="Black" 
                                                       Opacity="0.3" 
                                                       ShadowDepth="2" 
                                                       BlurRadius="8"/>
                                 </Border.Effect>
                                 <emoji:TextBlock Text="ðŸ’¡ å¦‚æžœä¸Šæ–¹æ›´æ–°æ¸ é“æ— æ³•æ­£å¸¸æ›´æ–°ï¼Œå¯ä»¥ç‚¹å‡»æ­¤æŒ‰é’®æ‰‹åŠ¨ä¸‹è½½å®‰è£…åŒ…è¿›è¡Œæ›´æ–°"
                                                  Foreground="#FFE6E6E6"
                                                  TextWrapping="Wrap"
                                                  FontSize="12"/>
                             </Border>
                             <!-- å°ä¸‰è§’å½¢æŒ‡ç¤ºå™¨ -->
                             <Polygon Points="0,0 10,0 5,8"
                                      Fill="#FF4A4A4A"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Bottom"
                                      Margin="0,0,0,-8"/>
                         </Grid>
                     </Popup>
                </Grid>
                <!--<ui:Button Grid.Column="1"
                           MinWidth="90"
                           Margin="8,0,8,0"
                           Appearance="Success"
                           Command="{Binding UpdateCommand}"
                           Content="ç«‹å³æ›´æ–°" />-->
                <ui:Button Name="IgnoreButton"
                           Grid.Column="2"
                           MinWidth="90"
                           Margin="8,0,8,0"
                           Command="{Binding IgnoreCommand}"
                           Content="ä¸å†æç¤º" />
                <ui:Button Grid.Column="3"
                           MinWidth="90"
                           Margin="8,0,8,0"
                           Command="{Binding CancelCommand}"
                           Content="å–æ¶ˆ" />
            </ui:Grid>
        </ui:Grid>
        <ui:TitleBar Title="{Binding Title, ElementName=app}"
                     ShowMaximize="False"
                     ShowMinimize="False">
            <ui:TitleBar.Icon>
                <ui:ImageIcon Source="pack://application:,,,/Resources/Images/logo.png" />
            </ui:TitleBar.Icon>
        </ui:TitleBar>
    </Grid>
</ui:FluentWindow>
